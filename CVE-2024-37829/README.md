<b><h2>Description</b></h2>

Outline <= v0.76.1 is vulnerable to Session Fixation, allowing an attacker to assign a known access token and steal sensitive information by tricking the victim into clicking their magic signin link. Specifically, when an authenticated user clicks another magic sign-in link, their access token is overwritten with the one embedded in the link. This results in the user and attacker sharing the same session because the magic signin link is not invalidated after it is used.

<b><h2>PoC</b></h2>


To exploit this vulnerability, follow the steps below:

1. Obtain a magic signin link by logging in with email


![image](https://github.com/sysentr0py/CVEs/assets/71945854/29dd2094-8275-4c71-b902-e8638a17f7dc)


2. Retrieve the magic signin link and send it to the victim


![Progetto senza titolo(2)](https://github.com/sysentr0py/CVEs/assets/71945854/0a554d19-4111-4486-bbe9-545a0ca8be44)


![image](https://github.com/sysentr0py/CVEs/assets/71945854/a87032a0-e497-4f66-acc8-de43b26c4fe9)


3. Once the victim clicks on the link, their access token is overwritten


![1720514137630blob](https://github.com/sysentr0py/CVEs/assets/71945854/f030d685-87d2-4e78-90c4-05c4b8f905fa)


![1720514137629blob](https://github.com/sysentr0py/CVEs/assets/71945854/7b85cf3c-c32a-4b4c-b0d7-d3701fab63fe)


<b><h2>References</b></h2>
- [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-37829](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-37829)
- [https://github.com/outline/outline/security/advisories/GHSA-xxww-hm7j-pr7q](https://github.com/outline/outline/security/advisories/GHSA-xxww-hm7j-pr7q)
