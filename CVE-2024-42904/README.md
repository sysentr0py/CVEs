<b><h2>Description</b></h2>

SysPass <= v3.2.x doesn't sanitize the client name during the account creation, resulting in a Stored-XSS.

Note: The vulnerability has not been fixed by the vendor, so future versions of SysPass are likely to be affected as well.

<b><h2>PoC</b></h2>

To exploit this vulnerability, follow the steps below:

1. Create a new account and specifying the following XSS payload as the client name: " id=x tabindex=1 onfocus=alert(1)>

   
![attachment_1](https://github.com/user-attachments/assets/e38502d4-4d56-4866-9611-c69e6b48ac1b)


2. Once the account is created, the payload will trigger the javascript execution in every page where it's stored.


![attachment_2](https://github.com/user-attachments/assets/446ec5a1-2fce-4ecf-ad6b-eb582f41d8e1)



<b><h2>References</b></h2>
- [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-42904](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-42904)
- [https://github.com/nuxsmin/sysPass/blob/9d0e169d2163897238877fb65130db47fe1ddcfa/app/modules/api/Controllers/ClientController.php#L89](https://github.com/nuxsmin/sysPass/blob/9d0e169d2163897238877fb65130db47fe1ddcfa/app/modules/api/Controllers/ClientController.php#L89)
- [https://github.com/nuxsmin/sysPass/blob/master/lib/SP/DataModel/ClientData.php#L98](https://github.com/nuxsmin/sysPass/blob/master/lib/SP/DataModel/ClientData.php#L98)
