<b><h2>Description</b></h2>

LimeSurvey <= v6.5.12 doesn't sanitize the name of the csv file used to import users. This results in a Stored-XSS vulnerability if an attacker with high privileges specifies a malicious payload as the csv file name.

<b><h2>PoC</b></h2>

To exploit this vulnerability, follow the steps below:

1. Browse to http://example.com/index.php?r=userManagement/index


2. Import a csv file by specifying an XSS payload in the name (i.e.: xss.csv<script onerror=alert(1) src=x>)


![Stored-XSS](https://github.com/user-attachments/assets/bc15343f-0f1e-4b96-a827-127890297923)


3. Stored-XSS is triggered when the page is refreshed.

![Stored-XSS2](https://github.com/user-attachments/assets/0aa26c33-c38f-4db5-bb76-571fbd8518d4)

![Stored-XSS3](https://github.com/user-attachments/assets/bf523d4c-bfb9-425c-9e00-f5896d4c0d6c)



<b><h2>References</b></h2>
- [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-42901](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-42901)
- [https://github.com/LimeSurvey/LimeSurvey/pull/3884](https://github.com/LimeSurvey/LimeSurvey/pull/3884)
